#!/usr/bin/env bash

# xlsof: Interactive utility to find files opened by a selected process command name

set -o nounset
set -o pipefail

readonly PROGRAM="${0##*/}"

process=$(ps axc | awk 'NR > 1' | awk '{print substr($0,index($0,$5))}' | sort -u | fzf)

if [[ -z "$process" ]]; then
    echo "$PROGRAM: no process selected" >&2
    exit 64
fi

lsof -c "$process" || exit 70
